(function(){(function(b){var a;a=b.App||{};a.Views=a.Views||{};a.Views.docV=Backbone.View.extend({initialize:function(){return this.linkOne=$(this.$el).find("nav#navigation").find("ul").find("li").find("a")[0]}});a.Views.mainResponseV=Backbone.View.extend({initialize:function(){var c=this;this.collection.on("add",this.addOne,this);this.collection.on("reset",this.reset,this);this.collection.reset();this.fetchingColl=this.collection.fetch();return this.fetchingColl.fail(function(){return c.errorMsg()})},addOne:function(d){var c;c=new a.Views.sectionV({model:d});c.reder();return $(this.$el).append(c.el)},reset:function(){return $(this.$el).html("")},isIe:function(){if($.browser!=null){if($.browser.msie!=null){this.errorMsg();return true}}return false},errorMsg:function(){return $(this.$el).html(a.Templates.Woops)},goTo:function(c){var d=this;this.deferred=$.Deferred();this.deferred.done(function(){var e;if(d.url!=null){e=d.url[1].split(":");return _.each($(d.$el).find("#"+d.url[0]).find(".box"),function(g,f){var i,h;i=$(g).data("modelid");if(i===e[0]){h=parseInt(e[1])-1;return $($(g).find(".articlePagination").find("a")[h]).trigger("click")}})}});this.fetchingColl.done(function(){$(d.$el).find("section").hide();return $(d.$el).find("#"+c).show()});return this.deferred.promise()}});a.Views.sectionV=Backbone.View.extend({tagName:"section",reder:function(){var c,d;$(this.$el).attr("id",this.model.get("name"));d={items:this.model.get("items"),name:this.model.get("name")};c=(Mustache.compile(a.Templates.boxItem))(d);$(this.$el).html(c);$(this.$el).hide();return this.setItemModels()},setItemModels:function(){var e,c,d,f=this;e=$(this.$el).find("div.box");if(this.allViews==null){this.allViews={}}d=this.model.get("name");c=[];_.each(e,function(k,i){var l,h,j,g;l=$(k).data("modelid");j=_.find(f.model.attributes.items,function(m){if(m.id===l){return m}});h=new a.Models.blogItem(j);g=new a.Views.blogItemV({model:h,el:$(k)});g.load();return c.push(g)});return this.allViews[d]=c},events:{"click .articlePagination a":"pagination","click a.readmore":"viewNote","click article header a":"viewNote"},viewNote:function(c){c.preventDefault();return console.log(c)},pagination:function(i){var c,h,d,j,g,f;i.preventDefault();$(i.currentTarget).closest("div").find("a").removeClass("active");$(i.currentTarget).addClass("active");f=parseInt($(i.currentTarget).html())-1;c=$(i.currentTarget).closest("div.box").find("article");$(c).hide();$($(c)[f]).show();d=$(i.currentTarget).closest(".box");h=$(d).data("modelid");g=$(i.currentTarget).closest("section");j=$(g).attr("id");return Backbone.history.navigate(""+j+"/"+h+":"+($(i.currentTarget).html()),{trigger:true})}});a.Views.blogItemV=Backbone.View.extend({render:function(){var f,c,e,d;f={entries:this.model.attributes.entries,model:this.model.attributes};d=(Mustache.compile(a.Templates.entries))(f);$(this.$el).html(d);$(this.$el).find("article").not(":eq(0)").hide();c=[];_.each(this.model.attributes.entries,function(h,g){return c.push({index:g+1})});f={items:c};d=(Mustache.compile(a.Templates.pagination))(f);$(this.$el).append(d);e=$(this.$el).find(".articlePagination").find("a")[0];return $(e).addClass("active")},load:function(){var d,c,e=this;this.deferred=$.Deferred();$(this.$el).append($('<div class="tmp"></div>'));c=$(this.$el).find(".tmp");$(c).hide();this.deferred.done(function(){e.render();return $(e.$el).find(".tmp").remove()});d={feeds:{feed:this.model.attributes.urlFeed},max:10,onComplete:function(f){e.model.attributes.entries=f;e.deferred.resolve();if(a.bundle.reponseV.url!=null){if(a.bundle.reponseV.url[1].split(":")[0]===e.model.attributes.id){return a.bundle.reponseV.deferred.resolve()}}}};$(c).feeds(d);return this.deferred.promise()}});return b.App=a})(window)}).call(this);